---------------------------------------------
PIC ASSEMBLER LISTING
Line    Address Opcode  Instruction
---------------------------------------------
0001    0000            ;DECLARACIONES VARIABLES
0002    0000            ;DATO EQU 0X21
0003    0000            ;stepper	EQU 0X7E
0004    0000            ;------------------------------ VARIABLES MOTORES INICIO --------------------------------------
0005    0000            CounterA EQU 0X21
0006    0000            CounterB EQU 0X22
0007    0000            CounterC EQU 0X23
0008    0000            
0009    0000            PasosX EQU 0X24                     ;Pasos que dara el motor por iteracion
0010    0000            PasosRegresoX EQU 0X25              ;Pasos que hara en el regreso para llegar posicion inical
0011    0000            PasosY EQU 0X26                     ;Pasos en Y para formar 0 a 90 grados
0012    0000            PasosRegresoY EQU 0X27              ;Pasos Regreso en Y de 90 a 0
0013    0000            NumeroIteracionesX EQU 0X28         ;Numero de veces que va hacer la iteracion de 90 (90*4 = 360)
0014    0000            
0015    0000            IrMayorXIteracion EQU 0X29          ;Guardar posicion de la iteracion en X donde encuentre mayor luz
0016    0000            IrMayorPasosY EQU 0X2A              ;Guardar posicion (pasos) en Y donde encuentre mas luz
0017    0000            
0018    0000            ;------------------------------ VARIABLES BOTON MOSTRAR INICIO --------------------------------------
0019    0000            ContadorBTN EQU 0X2B
0020    0000            DatoEnE  EQU 0X2C
0021    0000            NumGrupo  EQU 0X2D
0022    0000            
0023    0000            ;------------------------------ VARIABLES DISPLAY --------------------------------------
0024    0000            DATO_DISPLAY EQU 0X2E
0025    0000            
0026    0000            ;------------------------------Variables Foto Resistencia
0027    0000            ADC EQU 0x2F
0028    0000            CON EQU 0X30
0029    0000            CON2 EQU 0X31
0030    0000            CON3 EQU 0X32
0031    0000            MAYOR_LUZR EQU 0x33
0032    0000            MENOR_LUZR EQU 0x34
0033    0000            CATEGORIA EQU 0X35
0034    0000            ;------------------------------Comparacion Variables---------
0035    0000            Mayor_Encontrado EQU 0x36
0036    0000            Menor_Encontrado EQU 0x37
0037    0000            ENTRADA_Comp	EQU 0X38
0038    0000            ContMotorX	EQU 0X39
0039    0000            
0040    0000            RegresarReiniciarX	EQU 0x3A
0041    0000            RegresarReiniciarY	Equ 0x3B
0042    0000            ContMotorY	Equ 0x3C
0043    0000            INICIO
0044    0000            ;Inicio del programa ASIGNACIONES VARIABLES
0045    0000            	ORG	0X00
0046    0000            
0047    0000            ;------------------------CONFIGURACIONES PUERTOS --------------------------------------
0048    0000            ;------------------------------ PUERTO A y E JEFF --------------------------------------
0049    0000    1283    	bcf STATUS,RP0 ;Ir banco 0
0050    0001    1303    	bcf STATUS,RP1
0051    0002    3041    	movlw b'01000001' ;A/D conversion Fosc/8
0052    0003    009F    	movwf ADCON0
0053    0004            	;     	     7     6     5    4    3    2       1 0
0054    0004            	; 1Fh ADCON0 ADCS1 ADCS0 CHS2 CHS1 CHS0 GO/DONE ? ADON
0055    0004    1683    	bsf STATUS,RP0 ;Ir banco 1
0056    0005    1303    	bcf STATUS,RP1
0057    0006    3007    	movlw b'00000111'
0058    0007    0081    	movwf OPTION_REG ;TMR0 preescaler, 1:156
0059    0008            	;                7    6      5    4    3   2   1   0 
0060    0008            	; 81h OPTION_REG RBPU INTEDG T0CS T0SE PSA PS2 PS1 PS0
0061    0008    300E    	movlw b'00001110' ;A/D Port AN0/RA0
0062    0009    009F    	movwf ADCON1
0063    000A            	;            7    6     5 4 3     2     1     0 
0064    000A            	; 9Fh ADCON1 ADFM ADCS2 ? ? PCFG3 PCFG2 PCFG1 PCFG0
0065    000A    1405    	bsf TRISA,0 ;RA0 linea de entrada para el ADC
0066    000B    1283    	bcf STATUS,RP0 ;Ir banco 0
0067    000C    1303    	bcf STATUS,RP1
0068    000D            
0069    000D            ;------------------------------ PUERTO A y E --------------------------------------
0070    000D    3000    	MOVLW b'00000000'
0071    000E    00AB    	MOVWF ContadorBTN
0072    000F    00AE    	MOVWF DATO_DISPLAY
0073    0010            	
0074    0010            
0075    0010            ;----Desactive estas configuraiones para poder ver lo de JEFF
0076    0010            	;BSF     STATUS,RP0
0077    0010                ;BCF     STATUS,RP1
0078    0010                ;MOVLW   D'14'
0079    0010                ;MOVWF   ADCON1
0080    0010            	;MOVLW	B'111'
0081    0010                ;MOVWF   TRISE
0082    0010                ;BCF     STATUS,RP0
0083    0010                ;BCF     STATUS,RP1
0084    0010            
0085    0010    3007        	MOVLW   D'7'
0086    0011    00AD        	MOVWF   NumGrupo
0087    0012            ;------------------------------ PUERTO B --------------------------------------
0088    0012    1683    	BSF STATUS, 5 ;PONE 1 EN STATUS BIT 5 PARA MOVERNOS AL BANCO 1
0089    0013    0186    	CLRF TRISB; PONE EN 0 TRIS B Y LA BANDERA Z PONE SALIDA B 
0090    0014    0187    	CLRF TRISC; HABILITA EL PUERTO C COMO SALIDA
0091    0015            
0092    0015    0100    	CLRW; LIMPIAR W 
0093    0016    1283    	BCF STATUS, 5; PONE UN 0 EN BIT 5 Y NOS MOVEMOS AL BANCO 0 
0094    0017            
0095    0017            ;------------------------------ PUERTO C --------------------------------------
0096    0017    30FF    	MOVLW B'11111111'
0097    0018    00AE    	MOVWF DATO_DISPLAY
0098    0019            
0099    0019            ;--------------Configuracion de Mayores y menores
0100    0019            
0101    0019            ;PRUEBA para regresar el motor al mayor de luz  ELIMINAR
0102    0019            	;MOVLW	1 ; Moviendo a w El numero de iteraciones que vaya
0103    0019            	;MOVWF	IrMayorXIteracion 
0104    0019            	;MOVLW	45; Moviendo a W el numero de pasos que vaya en Y
0105    0019            	;MOVWF	IrMayorPasosY 
0106    0019            
0107    0019    281A    	GOTO	MENU ;mueve el ip al punto de la etiqueta
0108    001A            
0109    001A            ;--------------------------MENU PROGRAMA-------------------------------
0110    001A            MENU 
0111    001A    2023    	CAll	SeteoVariables
0112    001B    202E    	CALL	LOOP_GENERAL ; Mover Motores y buscar mayor luz 
0113    001C            	
0114    001C    0829    	MOVF	IrMayorXIteracion,W
0115    001D    00BA    	MOVWF	RegresarReiniciarX
0116    001E    082A    	MOVF	IrMayorPasosY,W
0117    001F    00BB    	MOVWF	RegresarReiniciarY
0118    0020            
0119    0020    208F    	CALL	IrMayorLuz ;Moverme a Buscar LUz
0120    0021    28CA    	GOTO	LEER_E_BTN
0121    0022            	;GOTO FotoResistencia ;Para Graduar Foto Resistencia 
0122    0022    2896    	GOTO	SALIR	
0123    0023            
0124    0023            SeteoVariables
0125    0023    3010    	MOVLW	16
0126    0024    00A8    	MOVWF	NumeroIteracionesX
0127    0025    3000    	MOVLW D'0'
0128    0026    00B6    	MOVWF Mayor_Encontrado
0129    0027    3009    	MOVLW D'9'
0130    0028    00B7    	MOVWF Menor_Encontrado
0131    0029    3000    	MOVLW	B'00000000'
0132    002A    0086    	MOVWF	PORTB
0133    002B    00A9    	MOVWF	IrMayorXIteracion
0134    002C    00AA    	MOVWF	IrMayorPasosY
0135    002D    0008    	Return
0136    002E            ;------------------------------ MOTORES INICIO --------------------------------------
0137    002E            LOOP_GENERAL
0138    002E    3020    	MOVLW	32			;32*16 =512
0139    002F    00A4    	MOVWF	PasosX
0140    0030    00A5    	MOVWF	PasosRegresoX
0141    0031    2044    	CALL	MOVER_X
0142    0032    3080    	MOVLW	128
0143    0033    00A6    	MOVWF	PasosY
0144    0034    00A7    	MOVWF	PasosRegresoY
0145    0035    0AB9    	INCF	ContMotorX,1
0146    0036    206F    	CALL	CORRIDAY
0147    0037    3000    	MOVLW	0
0148    0038    00BC    	MOVWF	ContMotorY
0149    0039    0BA8    	DECFSZ	NumeroIteracionesX, 1
0150    003A    282E    	GOTO	LOOP_GENERAL
0151    003B    3004    	MOVLW	4
0152    003C    00A8    	MOVWF	NumeroIteracionesX
0153    003D    283E    	GOTO	LOOP_REGRESO_X
0154    003E            
0155    003E            LOOP_REGRESO_X
0156    003E    3080    	MOVLW	128
0157    003F    00A5    	MOVWF	PasosRegresoX
0158    0040    2060    	CALL	REGRESOX
0159    0041    0BA8    	DECFSZ	NumeroIteracionesX, 1
0160    0042    283E    	GOTO	LOOP_REGRESO_X
0161    0043            	;GOTO	FIN
0162    0043    3400    	RETLW	B'00000000'
0163    0044            
0164    0044            MOVER_X
0165    0044    300C    	MOVLW	B'00001100'
0166    0045    0086    	MOVWF	PORTB
0167    0046    2053    	CALL	DelayOneSecond
0168    0047    3006    	MOVLW	B'00000110'
0169    0048    0086    	MOVWF	PORTB
0170    0049    2053    	CALL	DelayOneSecond
0171    004A    3003    	MOVLW	B'00000011'
0172    004B    0086    	MOVWF	PORTB
0173    004C    2053    	CALL	DelayOneSecond
0174    004D    3009    	MOVLW	B'00001001'
0175    004E    0086    	MOVWF	PORTB
0176    004F    2053    	CALL	DelayOneSecond
0177    0050    0BA4    	DECFSZ	PasosX,1
0178    0051    2844    	GOTO	MOVER_X
0179    0052    3400    	RETLW	B'00000000'
0180    0053            
0181    0053            DelayOneSecond
0182    0053    3001    	movlw D'1'
0183    0054    00A3    	movwf CounterC
0184    0055    3004    	movlw D'4'
0185    0056    00A2    	movwf CounterB
0186    0057    3004    	movlw D'4'
0187    0058    00A1    	movwf CounterA
0188    0059            
0189    0059            Loop_Delay
0190    0059    0BA1    	decfsz CounterA,1
0191    005A    2859    	goto Loop_Delay
0192    005B    0BA2    	decfsz CounterB,1
0193    005C    2859    	goto Loop_Delay
0194    005D    0BA3    	decfsz CounterC,1
0195    005E    2859    	goto Loop_Delay
0196    005F    3400    	RETLW	b'00000000'
0197    0060            
0198    0060            REGRESOX
0199    0060    3009    	MOVLW	B'00001001'
0200    0061    0086    	MOVWF	PORTB
0201    0062    2053    	CALL	DelayOneSecond
0202    0063    3003    	MOVLW	B'00000011'
0203    0064    0086    	MOVWF	PORTB
0204    0065    2053    	CALL	DelayOneSecond
0205    0066    3006    	MOVLW	B'00000110'
0206    0067    0086    	MOVWF	PORTB
0207    0068    2053    	CALL	DelayOneSecond
0208    0069    300C    	MOVLW	B'00001100'
0209    006A    0086    	MOVWF	PORTB
0210    006B    2053    	CALL	DelayOneSecond
0211    006C    0BA5    	DECFSZ	PasosRegresoX,1
0212    006D    2860    	GOTO	REGRESOX
0213    006E    3400    	RETLW	B'00000000'
0214    006F            
0215    006F            CORRIDAY
0216    006F    0ABC    	INCF	ContMotorY,1
0217    0070    2178    	CALL	BuscarYMarcarFoto
0218    0071    30C0       	MOVLW	B'11000000'
0219    0072    0086    	MOVWF	PORTB
0220    0073    2053    	CALL	DelayOneSecond
0221    0074    3060    	MOVLW	B'01100000'
0222    0075    0086    	MOVWF	PORTB
0223    0076    2053    	CALL	DelayOneSecond
0224    0077    3030    	MOVLW	B'00110000'
0225    0078    0086    	MOVWF	PORTB
0226    0079    2053    	CALL	DelayOneSecond
0227    007A    3090    	MOVLW	B'10010000'
0228    007B    0086    	MOVWF	PORTB
0229    007C    2053    	CALL	DelayOneSecond
0230    007D    0BA6    	DECFSZ	PasosY ,1
0231    007E    286F    	GOTO	CORRIDAY
0232    007F    2880    	GOTO	REGRESOY
0233    0080            
0234    0080            REGRESOY
0235    0080    3090        	MOVLW	B'10010000'
0236    0081    0086    	MOVWF	PORTB
0237    0082    2053    	CALL	DelayOneSecond
0238    0083    3030    	MOVLW	B'00110000'
0239    0084    0086    	MOVWF	PORTB
0240    0085    2053    	CALL	DelayOneSecond
0241    0086    3060    	MOVLW	B'01100000'
0242    0087    0086    	MOVWF	PORTB
0243    0088    2053    	CALL	DelayOneSecond
0244    0089    30C0    	MOVLW	B'11000000'
0245    008A    0086    	MOVWF	PORTB
0246    008B    2053    	CALL	DelayOneSecond
0247    008C    0BA7    	DECFSZ	PasosRegresoY ,1
0248    008D    2880    	GOTO	REGRESOY
0249    008E    3400    	RETLW	B'00000000'
0250    008F            
0251    008F            FIN ; NO se utiliza esta etiqueta se comenta en linea 62 
0252    008F             	;MOVLW	B'00000000'
0253    008F            	;MOVWF	PORTB
0254    008F            	;RETLW	B'00000000'
0255    008F            	;Call	IrMayorLuz
0256    008F            
0257    008F            
0258    008F            IrMayorLuz
0259    008F    3020    	MOVLW	32
0260    0090    00A4    	MOVWF	PasosX
0261    0091    2097    	CALL	FullMayorX
0262    0092    0BA9    	DECFSZ	IrMayorXIteracion , 1
0263    0093    288F    	GOTO	IrMayorLuz
0264    0094    20A6    	CALL	FullMayorY
0265    0095    3400    	RETLW	B'00000000'
0266    0096            
0267    0096            SALIR
0268    0096            	END
0269    0096    2896    	GOTO SALIR
0270    0097            
0271    0097            FullMayorX
0272    0097    300C    	MOVLW	B'00001100'
0273    0098    0086    	MOVWF	PORTB
0274    0099    2053    	CALL	DelayOneSecond
0275    009A    3006    	MOVLW	B'00000110'
0276    009B    0086    	MOVWF	PORTB
0277    009C    2053    	CALL	DelayOneSecond
0278    009D    3003    	MOVLW	B'00000011'
0279    009E    0086    	MOVWF	PORTB
0280    009F    2053    	CALL	DelayOneSecond
0281    00A0    3009    	MOVLW	B'00001001'
0282    00A1    0086    	MOVWF	PORTB
0283    00A2    2053    	CALL	DelayOneSecond
0284    00A3    0BA4    	DECFSZ	PasosX,1
0285    00A4    2897    	GOTO	FullMayorX
0286    00A5    3400    	RETLW	B'00000000'
0287    00A6            
0288    00A6            FullMayorY
0289    00A6    30C0       	MOVLW	B'11000000'
0290    00A7    0086    	MOVWF	PORTB
0291    00A8    2053    	CALL	DelayOneSecond
0292    00A9    3060    	MOVLW	B'01100000'
0293    00AA    0086    	MOVWF	PORTB
0294    00AB    2053    	CALL	DelayOneSecond
0295    00AC    3030    	MOVLW	B'00110000'
0296    00AD    0086    	MOVWF	PORTB
0297    00AE    2053    	CALL	DelayOneSecond
0298    00AF    3090    	MOVLW	B'10010000'
0299    00B0    0086    	MOVWF	PORTB
0300    00B1    2053    	CALL	DelayOneSecond
0301    00B2    0BAA    	DECFSZ	IrMayorPasosY ,1
0302    00B3    28A6    	GOTO	FullMayorY
0303    00B4    3400    	RETLW	B'00000000'
0304    00B5            
0305    00B5            ReiniciarTOTALX
0306    00B5    3020    	MOVLW	32
0307    00B6    00A5    	MOVWF	PasosRegresoX
0308    00B7    2060    	CALL	REGRESOX
0309    00B8    0BBA    	DECFSZ	RegresarReiniciarX, 1
0310    00B9    28B5    	GOTO	ReiniciarTOTALX
0311    00BA            	;GOTO	FIN
0312    00BA    3400    	RETLW	B'00000000'
0313    00BB            ReiniciarTOTALY
0314    00BB    3090        	MOVLW	B'10010000'
0315    00BC    0086    	MOVWF	PORTB
0316    00BD    2053    	CALL	DelayOneSecond
0317    00BE    3030    	MOVLW	B'00110000'
0318    00BF    0086    	MOVWF	PORTB
0319    00C0    2053    	CALL	DelayOneSecond
0320    00C1    3060    	MOVLW	B'01100000'
0321    00C2    0086    	MOVWF	PORTB
0322    00C3    2053    	CALL	DelayOneSecond
0323    00C4    30C0    	MOVLW	B'11000000'
0324    00C5    0086    	MOVWF	PORTB
0325    00C6    2053    	CALL	DelayOneSecond
0326    00C7    0BBB    	DECFSZ	RegresarReiniciarY ,1
0327    00C8    28BB    	GOTO	ReiniciarTOTALY
0328    00C9    3400    	RETLW	B'00000000'
0329    00CA            ;------------------------------ BOTON E 0 INICIAL -----------------------------------------
0330    00CA            LEER_E_BTN
0331    00CA    0809    	MOVF PORTE, W ;Movemos lo de PUERTO E hacia W
0332    00CB    00AC    	MOVWF DatoEnE ;Movemos la variable hacia dato en E
0333    00CC    3001    	MOVLW B'001' ; MOVEMOS A W EL 0 BIT de E  
0334    00CD    022C    	SUBWF DatoEnE,W ;VA A RESTARLE AL DATO E LO QUE ESTA EN W
0335    00CE    21EC    	CALL	Llamada16Delays
0336    00CF    1903    	BTFSC STATUS, Z ; VERIFICA QUE EL STATUS DE LA OPERACION SEA 0 
0337    00D0    28D9    	GOTO  CONTAR ; SI LA OPERACION ES 0 SE VA A UN CONTAR
0338    00D1            
0339    00D1    3004    	MOVLW B'100'
0340    00D2    022C    	SUBWF DatoEnE,w
0341    00D3    1903    	BTFSC STATUS, Z ; VERIFICA QUE EL STATUS DE LA OPERACION SEA 0 
0342    00D4    28D6    	GOTO  EmpezarDeNuevo ; SI LA OPERACION ES 0 SE VA A UN CONTAR
0343    00D5            
0344    00D5            
0345    00D5    28CA    	GOTO  LEER_E_BTN ;REGRESA LOOP LEER
0346    00D6            
0347    00D6            EmpezarDeNuevo
0348    00D6    20BB    	CAll	ReiniciarTOTALY
0349    00D7    20B5    	Call	ReiniciarTOTALX
0350    00D8    281A    	GOTO	MENU	
0351    00D9            
0352    00D9            CONTAR
0353    00D9    0A2B    	INCF  ContadorBTN, 0 ;incrementa e ContadorBTN en 1
0354    00DA    00AB    	MOVWF ContadorBTN
0355    00DB    3001    	MOVLW b'00000001'
0356    00DC    022B    	SUBWF ContadorBTN,W
0357    00DD    1903    	BTFSC STATUS, Z
0358    00DE    28EB    	GOTO  BTN1
0359    00DF            
0360    00DF    3002    	MOVLW b'00000010'
0361    00E0    022B    	SUBWF ContadorBTN,W
0362    00E1    1903    	BTFSC STATUS, Z
0363    00E2    291E    	GOTO  BTN2
0364    00E3            
0365    00E3    3003    	MOVLW b'00000011'
0366    00E4    022B    	SUBWF ContadorBTN,W
0367    00E5    1903    	BTFSC STATUS, Z
0368    00E6    2922    	GOTO  BTN3
0369    00E7            
0370    00E7    3004    	MOVLW b'00000100'
0371    00E8    022B    	SUBWF ContadorBTN, 0
0372    00E9    1903    	BTFSC STATUS, Z
0373    00EA    2926    	GOTO  BTN4
0374    00EB            
0375    00EB            BTN1
0376    00EB            ;Al iniciar, mostrar cu�nto es el �ndice de luz (escala definida por el grupo)
0377    00EB            	;MOVLW B'00000001'
0378    00EB            	;MOVWF PORTB
0379    00EB            
0380    00EB    3000    	MOVLW D'0'
0381    00EC    00AE    	MOVWF DATO_DISPLAY
0382    00ED    212C    	CALL  COMP_DISPLAY
0383    00EE    21EC    	CALL	Llamada16Delays
0384    00EF    21EC    	CALL	Llamada16Delays
0385    00F0            
0386    00F0    3001    	MOVLW D'1'
0387    00F1    00AE    	MOVWF DATO_DISPLAY
0388    00F2    212C    	CALL  COMP_DISPLAY
0389    00F3    21EC    	CALL	Llamada16Delays
0390    00F4    21EC    	CALL	Llamada16Delays
0391    00F5            
0392    00F5    3002    	MOVLW D'2'
0393    00F6    00AE    	MOVWF DATO_DISPLAY
0394    00F7    212C    	CALL  COMP_DISPLAY
0395    00F8    21EC    	CALL	Llamada16Delays
0396    00F9    21EC    	CALL	Llamada16Delays
0397    00FA            
0398    00FA    3003    	MOVLW D'3'
0399    00FB    00AE    	MOVWF DATO_DISPLAY
0400    00FC    212C    	CALL  COMP_DISPLAY
0401    00FD    21EC    	CALL	Llamada16Delays
0402    00FE    21EC    	CALL	Llamada16Delays
0403    00FF            
0404    00FF    3004    	MOVLW D'4'
0405    0100    00AE    	MOVWF DATO_DISPLAY
0406    0101    212C    	CALL  COMP_DISPLAY
0407    0102    21EC    	CALL	Llamada16Delays
0408    0103    21EC    	CALL	Llamada16Delays
0409    0104            
0410    0104    3005    	MOVLW D'5'
0411    0105    00AE    	MOVWF DATO_DISPLAY
0412    0106    212C    	CALL  COMP_DISPLAY
0413    0107    21EC    	CALL	Llamada16Delays
0414    0108    21EC    	CALL	Llamada16Delays
0415    0109            
0416    0109    3006    	MOVLW D'6'
0417    010A    00AE    	MOVWF DATO_DISPLAY
0418    010B    212C    	CALL  COMP_DISPLAY
0419    010C    21EC    	CALL	Llamada16Delays
0420    010D    21EC    	CALL	Llamada16Delays
0421    010E            
0422    010E    3007    	MOVLW D'7'
0423    010F    00AE    	MOVWF DATO_DISPLAY
0424    0110    212C    	CALL  COMP_DISPLAY
0425    0111    21EC    	CALL	Llamada16Delays
0426    0112    21EC    	CALL	Llamada16Delays
0427    0113            
0428    0113    3008    	MOVLW D'8'
0429    0114    00AE    	MOVWF DATO_DISPLAY
0430    0115    212C    	CALL  COMP_DISPLAY
0431    0116    21EC    	CALL	Llamada16Delays
0432    0117    21EC    	CALL	Llamada16Delays
0433    0118            
0434    0118    3009    	MOVLW D'9'
0435    0119    00AE    	MOVWF DATO_DISPLAY
0436    011A    212C    	CALL  COMP_DISPLAY
0437    011B    21EC    	CALL	Llamada16Delays
0438    011C    21EC    	CALL	Llamada16Delays
0439    011D            
0440    011D    28CA    	GOTO  LEER_E_BTN
0441    011E            	;Mostrar el primer inciso
0442    011E            BTN2
0443    011E            ;Al presionar la tecla cambiar� y deber� mostrar el n�mero del dispositivo con la mayor
0444    011E            ;cantidad de luz.
0445    011E            	;MOVLW B'00000010'
0446    011E            	;MOVWF PORTB
0447    011E            	
0448    011E    3002    	MOVLW D'2'
0449    011F    00AE    	MOVWF DATO_DISPLAY
0450    0120            
0451    0120    212C    	CALL  COMP_DISPLAY
0452    0121            
0453    0121    28CA    	GOTO  LEER_E_BTN
0454    0122            	;Mostrar el segundo inciso
0455    0122            BTN3
0456    0122            ;Al presionar la tecla cambiar� y deber� mostrar el n�mero del dispositivo con la menor
0457    0122            ;cantidad de luz.
0458    0122            	;MOVLW B'00000100'
0459    0122            	;MOVWF PORTB
0460    0122            
0461    0122    3003    	MOVLW D'3'
0462    0123    00AE    	MOVWF DATO_DISPLAY
0463    0124    212C    	CALL  COMP_DISPLAY
0464    0125            
0465    0125    28CA    	GOTO  LEER_E_BTN
0466    0126            	;Mostrar el tercer inciso
0467    0126            BTN4       ;Al presionar la tecla cambiar� y mostrar� cu�l es su n�mero de dispositivo
0468    0126            	;MOVLW B'00001000'
0469    0126            	;MOVWF PORTB
0470    0126            
0471    0126    3000    	MOVLW B'00000000' 
0472    0127    00AB    	MOVWF ContadorBTN ;resetea el ContadorBTN para empezar de nuevo
0473    0128            
0474    0128    3004    	MOVLW D'4'
0475    0129    00AE    	MOVWF DATO_DISPLAY
0476    012A    212C    	CALL  COMP_DISPLAY
0477    012B    28CA    	GOTO  LEER_E_BTN
0478    012C            
0479    012C            
0480    012C            ;------------------------------ DISPLAY  -----------------------------------------
0481    012C            
0482    012C            COMP_DISPLAY
0483    012C            ;COMPARACION BIT POR BIT 
0484    012C    3000    	MOVLW	B'00000000' ;LE ENVIAMOS A W EL NUMERO 0 EN BINARIO EN 8 BITS
0485    012D    022E    	SUBWF	DATO_DISPLAY,W 	;LE VAMOS A QUITAR A DATO_DISPLAY W (DATO_DISPLAY-W)=W
0486    012E    1903    	BTFSC	STATUS,Z
0487    012F    2955    	GOTO	MOSTRAR0
0488    0130            
0489    0130    3001    	MOVLW	B'00000001' ;LE ENVIAMOS A W EL NUMERO 1 EN BINARIO EN 8 BITS
0490    0131    022E    	SUBWF	DATO_DISPLAY,W 	;LE VAMOS A QUITAR A DATO_DISPLAY W (DATO_DISPLAY-W)=W
0491    0132    1903    	BTFSC	STATUS,Z
0492    0133    2958    	GOTO	MOSTRAR1
0493    0134            
0494    0134    3002    	MOVLW	B'00000010' ;LE ENVIAMOS A W EL NUMERO 2 EN BINARIO EN 8 BITS
0495    0135    022E    	SUBWF	DATO_DISPLAY,W 	;LE VAMOS A QUITAR A DATO_DISPLAY W (DATO_DISPLAY-W)=W
0496    0136    1903    	BTFSC	STATUS,Z
0497    0137    295B    	GOTO	MOSTRAR2
0498    0138            	
0499    0138    3003    	MOVLW	B'00000011' ;LE ENVIAMOS A W EL NUMERO 3 EN BINARIO EN 8 BITS
0500    0139    022E    	SUBWF	DATO_DISPLAY,W 	;LE VAMOS A QUITAR A DATO_DISPLAY W (DATO_DISPLAY-W)=W
0501    013A    1903    	BTFSC	STATUS,Z
0502    013B    295E    	GOTO	MOSTRAR3
0503    013C            
0504    013C    3004    	MOVLW	B'00000100' ;LE ENVIAMOS A W EL NUMERO 4 EN BINARIO EN 8 BITS
0505    013D    022E    	SUBWF	DATO_DISPLAY,W 	;LE VAMOS A QUITAR A DATO_DISPLAY W (DATO_DISPLAY-W)=W
0506    013E    1903    	BTFSC	STATUS,Z
0507    013F    2961    	GOTO	MOSTRAR4
0508    0140            
0509    0140    3005    	MOVLW	B'00000101' ;LE ENVIAMOS A W EL NUMERO 5 EN BINARIO EN 8 BITS
0510    0141    022E    	SUBWF	DATO_DISPLAY,W 	;LE VAMOS A QUITAR A DATO_DISPLAY W (DATO_DISPLAY-W)=W
0511    0142    1903    	BTFSC	STATUS,Z
0512    0143    2964    	GOTO	MOSTRAR5
0513    0144            
0514    0144    3006    	MOVLW	B'00000110' ;LE ENVIAMOS A W EL NUMERO 6 EN BINARIO EN 8 BITS
0515    0145    022E    	SUBWF	DATO_DISPLAY,W 	;LE VAMOS A QUITAR A DATO_DISPLAY W (DATO_DISPLAY-W)=W
0516    0146    1903    	BTFSC	STATUS,Z
0517    0147    2967    	GOTO	MOSTRAR6
0518    0148            
0519    0148    3007    	MOVLW	B'00000111' ;LE ENVIAMOS A W EL NUMERO 7 EN BINARIO EN 8 BITS
0520    0149    022E    	SUBWF	DATO_DISPLAY,W 	;LE VAMOS A QUITAR A DATO_DISPLAY W (DATO_DISPLAY-W)=W
0521    014A    1903    	BTFSC	STATUS,Z
0522    014B    296A    	GOTO	MOSTRAR7
0523    014C            
0524    014C    3008    	MOVLW	B'00001000' ;LE ENVIAMOS A W EL NUMERO 8 EN BINARIO EN 8 BITS
0525    014D    022E    	SUBWF	DATO_DISPLAY,W 	;LE VAMOS A QUITAR A DATO_DISPLAY W (DATO_DISPLAY-W)=W
0526    014E    1903    	BTFSC	STATUS,Z
0527    014F    296D    	GOTO	MOSTRAR8
0528    0150            
0529    0150    3009    	MOVLW	B'00001001' ;LE ENVIAMOS A W EL NUMERO 9 EN BINARIO EN 8 BITS
0530    0151    022E    	SUBWF	DATO_DISPLAY,W 	;LE VAMOS A QUITAR A DATO_DISPLAY W (DATO_DISPLAY-W)=W
0531    0152    1903    	BTFSC	STATUS,Z
0532    0153    2970    	GOTO	MOSTRAR9
0533    0154            	
0534    0154            	;MOVLW	B'00000000'
0535    0154            	;MOVWF	PORTB
0536    0154    28CA    	GOTO	LEER_E_BTN
0537    0155            
0538    0155            MOSTRAR0
0539    0155    30C0    	MOVLW B'11000000' ; EN BINARIO PONEMOS 0 LOS NECESARIOS PARA PREDER EL DISPLAY EN 0
0540    0156    0087    	MOVWF PORTC	;MOVEMOS LOS BINARIOS A PORT B 
0541    0157    3400    	RETLW	B'00000000'
0542    0158            
0543    0158            MOSTRAR1
0544    0158    30F9    	MOVLW B'11111001' ; EN BINARIO PONEMOS 1 LOS NECESARIOS PARA PREDER EL DISPLAY EN 0
0545    0159    0087    	MOVWF PORTC	;MOVEMOS LOS BINARIOS A PORT B 
0546    015A    3400    	RETLW	B'00000000'
0547    015B            
0548    015B            MOSTRAR2
0549    015B    30A4    	MOVLW B'10100100' ; EN BINARIO PONEMOS 2 LOS NECESARIOS PARA PREDER EL DISPLAY EN 0
0550    015C    0087    	MOVWF PORTC	;MOVEMOS LOS BINARIOS A PORT B 
0551    015D    3400    	RETLW	B'00000000'
0552    015E            
0553    015E            MOSTRAR3
0554    015E    30B0    	MOVLW B'10110000' ; EN BINARIO PONEMOS 3 LOS NECESARIOS PARA PREDER EL DISPLAY EN 0
0555    015F    0087    	MOVWF PORTC	;MOVEMOS LOS BINARIOS A PORT B 
0556    0160    3400    	RETLW	B'00000000'
0557    0161            		
0558    0161            MOSTRAR4
0559    0161    3099    	MOVLW B'10011001' ; EN BINARIO PONEMOS 4 LOS NECESARIOS PARA PREDER EL DISPLAY EN 0
0560    0162    0087    	MOVWF PORTC	;MOVEMOS LOS BINARIOS A PORT B 
0561    0163    3400    	RETLW	B'00000000'
0562    0164            
0563    0164            MOSTRAR5
0564    0164    3092    	MOVLW B'10010010' ; EN BINARIO PONEMOS 5 LOS NECESARIOS PARA PREDER EL DISPLAY EN 0
0565    0165    0087    	MOVWF PORTC	;MOVEMOS LOS BINARIOS A PORT B 
0566    0166    3400    	RETLW	B'00000000'
0567    0167            
0568    0167            MOSTRAR6
0569    0167    3082    	MOVLW B'10000010' ; EN BINARIO PONEMOS 6 LOS NECESARIOS PARA PREDER EL DISPLAY EN 0
0570    0168    0087    	MOVWF PORTC	;MOVEMOS LOS BINARIOS A PORT B 
0571    0169    3400    	RETLW	B'00000000'
0572    016A            
0573    016A            MOSTRAR7
0574    016A    30F8    	MOVLW B'11111000' ; EN BINARIO PONEMOS 7 LOS NECESARIOS PARA PREDER EL DISPLAY EN 0
0575    016B    0087    	MOVWF PORTC	;MOVEMOS LOS BINARIOS A PORT B 
0576    016C    3400    	RETLW	B'00000000'
0577    016D            
0578    016D            MOSTRAR8
0579    016D    3080    	MOVLW B'10000000' ; EN BINARIO PONEMOS 8 LOS NECESARIOS PARA PREDER EL DISPLAY EN 0
0580    016E    0087    	MOVWF PORTC	;MOVEMOS LOS BINARIOS A PORT B 
0581    016F    3400    	RETLW	B'00000000'
0582    0170            
0583    0170            MOSTRAR9
0584    0170    3098    	MOVLW B'10011000' ; EN BINARIO PONEMOS 9 LOS NECESARIOS PARA PREDER EL DISPLAY EN 0
0585    0171    0087    	MOVWF PORTC	;MOVEMOS LOS BINARIOS A PORT B 
0586    0172    3400    	RETLW	B'00000000'
0587    0173            
0588    0173            ;------------------------------FOTO RESISTENCIA  -----------------------------------------
0589    0173            FotoResistencia
0590    0173    217D    	CALL _bucle
0591    0174    0835    	MOVF	CATEGORIA,W
0592    0175    00AE    	MOVWF DATO_DISPLAY
0593    0176    212C    	CALL  COMP_DISPLAY
0594    0177    2973    	GOTO FotoResistencia
0595    0178            
0596    0178            BuscarYMarcarFoto
0597    0178    217D    	Call _bucle
0598    0179    0835    	MovF categoria,W
0599    017A    00B8    	MOVWF ENTRADA_Comp
0600    017B    21D9    	Call Comparacion_nums
0601    017C    0008    	RETURN
0602    017D            
0603    017D            _bucle
0604    017D            	;btfss INTCON,T0IF
0605    017D            	;goto _bucle ;Esperar que el timer0 desborde
0606    017D            	; SE DEBE DE COLOCAR UN DELAY PARA QUE ESPERE LA CONVERSION
0607    017D    1503    	BSF  STATUS,Z
0608    017E    2189    	CALL _PRESPERA
0609    017F    110B    	bcf INTCON,T0IF ;Limpiar el indicador de desborde
0610    0180    151F    	bsf ADCON0,GO ;Comenzar conversion A/D
0611    0181            _espera
0612    0181    191F    	btfsc ADCON0,GO ;ADCON0 es 0? (la conversion esta completa?)
0613    0182    2981    	goto _espera ;No, ir _espera
0614    0183    081E    	movf ADRESH,W ;Si, W=ADRESH
0615    0184            	; 1Eh ADRESH A/D Result Register High Byte
0616    0184            	; 9Eh ADRESL A/D Result Register Low Byte 
0617    0184    00AF    	movwf ADC ;ADC=W
0618    0185            	;rrf ADC,F ;ADC /4
0619    0185            	;rrf ADC,F
0620    0185            	;bcf ADC,7
0621    0185            	;bcf ADC,6
0622    0185    082F    	movfw ADC ;W = ADC
0623    0186            	;movwf PORTB ;PORTB = W
0624    0186    219A    	CALL INTERVALOS
0625    0187    21CA    	CALL COMPARACION_Foto
0626    0188    0008    	RETURN
0627    0189            	;movlw D'32' ;Comparamos el valor del ADC para saber si es menor que 128
0628    0189            	;subwf ADC,W
0629    0189            	;btfss STATUS,C ;Es mayor a 128?
0630    0189            	;goto _desactivar ;No, desactivar RB7
0631    0189            	;bsf PORTC,7 ;Si, RB7 = 1 logico
0632    0189            	;goto _bucle ;Ir bucle
0633    0189            ;_desactivar
0634    0189            	;bcf PORTB,7 ;RB7 = 0 logico
0635    0189            	;goto _bucle ;Ir bucle
0636    0189            	
0637    0189            _PRESPERA
0638    0189    30FF    	MOVLW 0XFF
0639    018A    00B0    	MOVWF CON
0640    018B    00B1    	MOVWF CON2
0641    018C    00B2    	MOVWF CON3	
0642    018D    218F    	CALL ESPE
0643    018E    0008    	RETURN	
0644    018F            
0645    018F            ESPE
0646    018F    0BB0    	DECFSZ	CON,0X01
0647    0190    298F    	GOTO	ESPE
0648    0191    2193    	CALL	ESPE2
0649    0192    0008    	RETURN
0650    0193            ESPE2
0651    0193    0BB1    	DECFSZ	CON2,0X01
0652    0194    2993    	GOTO	ESPE2
0653    0195    2197    	CALL	ESPE3
0654    0196    0008    	RETURN
0655    0197            ESPE3
0656    0197    0BB2    	DECFSZ	CON3,0X01
0657    0198    2997    	GOTO	ESPE3
0658    0199    0008    	RETURN
0659    019A            
0660    019A            INTERVALOS
0661    019A    3009    	MOVLW	D'9'
0662    019B    00B5    	MOVWF	CATEGORIA
0663    019C            
0664    019C    30D2    	movlw	d'210'
0665    019D    022F    	subwf	ADC, 0
0666    019E    1803    	BTFSc	STATUS, C
0667    019F    0008    	RETURN
0668    01A0            
0669    01A0    03B5    	DECF	categoria,1
0670    01A1    30C2    	movlw	d'194'
0671    01A2    022F    	subwf	ADC, 0
0672    01A3    1803    	BTFSC STATUS, C
0673    01A4    0008    	return
0674    01A5            
0675    01A5    03B5    	DECF	categoria,1
0676    01A6    30AE    	movlw	d'174'
0677    01A7    022F    	subwf	ADC, 0
0678    01A8    1803    	BTFSC STATUS, C
0679    01A9    0008    	return
0680    01AA            
0681    01AA    03B5    	DECF	categoria,1
0682    01AB    309E    	movlw	d'158'
0683    01AC    022F    	subwf	ADC, 0
0684    01AD    1803    	BTFSC STATUS, C
0685    01AE    0008    	return
0686    01AF            
0687    01AF    03B5    	DECF	categoria,1
0688    01B0    308A    	movlw	d'138'
0689    01B1    022F    	subwf	ADC, 0
0690    01B2    1803    	BTFSC STATUS, C
0691    01B3    0008    	return
0692    01B4            
0693    01B4    03B5    	DECF	categoria,1
0694    01B5    3075    	movlw	d'117'
0695    01B6    022F    	subwf	ADC, 0
0696    01B7    1803    	BTFSC STATUS, C
0697    01B8    0008    	return
0698    01B9            
0699    01B9    03B5    	DECF	categoria,1
0700    01BA    3052    	movlw	d'82'
0701    01BB    022F    	subwf	ADC, 0
0702    01BC    1803    	BTFSC STATUS, C
0703    01BD    0008    	return
0704    01BE            
0705    01BE    03B5    	DECF	categoria,1
0706    01BF    3033    	movlw	d'51'
0707    01C0    022F    	subwf	ADC, 0
0708    01C1    1803    	BTFSC STATUS, C
0709    01C2    0008    	return
0710    01C3            
0711    01C3    03B5    	DECF	categoria,1
0712    01C4    301C    	movlw	d'28'
0713    01C5    022F    	subwf	ADC, 0
0714    01C6    1803    	BTFSC STATUS, C
0715    01C7    0008    	return
0716    01C8            	
0717    01C8    03B5    	DECF	categoria, 1
0718    01C9    0008    	return
0719    01CA            
0720    01CA            COMPARACION_Foto	
0721    01CA    0835    	MOVF	CATEGORIA,W
0722    01CB    0234    	SUBWF	MENOR_LUZR,W	
0723    01CC    1803    	BTFSC	STATUS,C
0724    01CD    21D6    	CALL	EntradaMenor
0725    01CE            
0726    01CE    0835    	MOVF	CATEGORIA,W
0727    01CF    0233    	SUBWF	MAYOR_LUZR,W
0728    01D0    1C03    	BTFSS	STATUS,C
0729    01D1    21D3    	CALL 	EntradaMayor
0730    01D2            
0731    01D2    0008    	RETURN
0732    01D3            
0733    01D3            EntradaMayor
0734    01D3    0835    	MOVF	CATEGORIA,W
0735    01D4    00B3    	MOVWF	MAYOR_LUZR
0736    01D5            	;MOVLW	B'00000001'
0737    01D5            	;MOVWF	PORTD
0738    01D5    0008    	RETURN
0739    01D6            
0740    01D6            EntradaMenor
0741    01D6    0835    	MOVF	CATEGORIA,W
0742    01D7    00B4    	MOVWF	MENOR_LUZR
0743    01D8            	;MOVLW	B'00000010'
0744    01D8            	;MOVWF	PORTD
0745    01D8    0008    	RETURN
0746    01D9            ;--------------------------Compracion numeros----------------------------------------------
0747    01D9            Comparacion_nums	
0748    01D9    0838    	MOVF	ENTRADA_Comp,W
0749    01DA    0237    	SUBWF	Menor_Encontrado,W	
0750    01DB    1803    	BTFSC	STATUS,C
0751    01DC    21E9    	CALL	EntradaMenor_nums
0752    01DD            
0753    01DD    0838    	MOVF	ENTRADA_Comp,W
0754    01DE    0236    	SUBWF	Mayor_Encontrado,W
0755    01DF    1C03    	BTFSS	STATUS,C
0756    01E0    21E2    	CALL 	EntradaMayor_nums
0757    01E1            
0758    01E1    0008    	RETURN
0759    01E2            
0760    01E2            EntradaMayor_nums
0761    01E2    0838    	MOVF	ENTRADA_Comp,W
0762    01E3    00B6    	MOVWF	Mayor_Encontrado
0763    01E4            	;Moviendo la Iteracion X y Moviento en y
0764    01E4    0839    	MOVF 	ContMotorX,W
0765    01E5    00A9    	MOVWF	IrMayorXIteracion
0766    01E6            	;INCF	IrMayorXIteracion,1
0767    01E6            
0768    01E6    083C    	MOVF 	ContMotorY,W
0769    01E7    00AA    	MOVWF	IrMayorPasosY
0770    01E8            
0771    01E8            	;MOVLW	B'00000001'
0772    01E8            	;MOVWF	PORTD
0773    01E8    0008    	RETURN
0774    01E9            
0775    01E9            EntradaMenor_nums
0776    01E9    0838    	MOVF	ENTRADA_Comp,W
0777    01EA    00B7    	MOVWF	Menor_Encontrado
0778    01EB            	;MOVLW	B'00000010'
0779    01EB            	;MOVWF	PORTD
0780    01EB    0008    	RETURN
0781    01EC            
0782    01EC            ;---------------------------------------Procedimientos Varios ---------------------------------
0783    01EC            Llamada16Delays
0784    01EC    2053    	CALL	DelayOneSecond
0785    01ED    2053    	CALL	DelayOneSecond	
0786    01EE    2053    	CALL	DelayOneSecond
0787    01EF    2053    	CALL	DelayOneSecond
0788    01F0    2053    	CALL	DelayOneSecond
0789    01F1    2053    	CALL	DelayOneSecond	
0790    01F2    2053    	CALL	DelayOneSecond
0791    01F3    2053    	CALL	DelayOneSecond
0792    01F4    2053    	CALL	DelayOneSecond
0793    01F5    2053    	CALL	DelayOneSecond	
0794    01F6    2053    	CALL	DelayOneSecond
0795    01F7    2053    	CALL	DelayOneSecond
0796    01F8    2053    	CALL	DelayOneSecond
0797    01F9    2053    	CALL	DelayOneSecond	
0798    01FA    2053    	CALL	DelayOneSecond
0799    01FB    2053    	CALL	DelayOneSecond
0800    01FC    0008    	RETURN
0801    01FD            
0802    01FD            ;--------------------------------------REINICIAR-------------------------------------------
0803    01FD            
---------------------------------------------
Number of errors = 0
