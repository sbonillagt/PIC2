---------------------------------------------
PIC ASSEMBLER LISTING
Line    Address Opcode  Instruction
---------------------------------------------
0001    0000            ;DECLARACIONES VARIABLES
0002    0000            ;DATO EQU 0X21
0003    0000            ;stepper	EQU 0X7E
0004    0000            ;------------------------------ VARIABLES MOTORES INICIO --------------------------------------
0005    0000            CounterA EQU 0X21
0006    0000            CounterB EQU 0X22
0007    0000            CounterC EQU 0X23
0008    0000            
0009    0000            PasosX EQU 0X24                     ;Pasos que dara el motor por iteracion
0010    0000            PasosRegresoX EQU 0X25              ;Pasos que hara en el regreso para llegar posicion inical
0011    0000            PasosY EQU 0X26                     ;Pasos en Y para formar 0 a 90 grados
0012    0000            PasosRegresoY EQU 0X27              ;Pasos Regreso en Y de 90 a 0
0013    0000            NumeroIteracionesX EQU 0X28         ;Numero de veces que va hacer la iteracion de 90 (90*4 = 360)
0014    0000            
0015    0000            IrMayorXIteracion EQU 0X29          ;Guardar posicion de la iteracion en X donde encuentre mayor luz
0016    0000            IrMayorPasosY EQU 0X2A              ;Guardar posicion (pasos) en Y donde encuentre mas luz
0017    0000            
0018    0000            ;------------------------------ VARIABLES BOTON MOSTRAR INICIO --------------------------------------
0019    0000            ContadorBTN EQU 0X2B
0020    0000            DatoEnE  EQU 0X2C
0021    0000            NumGrupo  EQU 0X2D
0022    0000            
0023    0000            ;------------------------------ VARIABLES DISPLAY --------------------------------------
0024    0000            DATO_DISPLAY EQU 0X2E
0025    0000            
0026    0000            ;------------------------------Variables Foto Resistencia
0027    0000            ADC EQU 0x2F
0028    0000            CON EQU 0X30
0029    0000            CON2 EQU 0X31
0030    0000            CON3 EQU 0X32
0031    0000            MAYOR_LUZR EQU 0x33
0032    0000            MENOR_LUZR EQU 0x34
0033    0000            CATEGORIA EQU 0X35
0034    0000            ;------------------------------Comparacion Variables---------
0035    0000            Mayor_Encontrado EQU 0x36
0036    0000            Menor_Encontrado EQU 0x37
0037    0000            ENTRADA_Comp	EQU 0X38
0038    0000            ContMotor	EQU 0X39
0039    0000            
0040    0000            INICIO
0041    0000            ;Inicio del programa ASIGNACIONES VARIABLES
0042    0000            	ORG	0X00
0043    0000            
0044    0000            ;------------------------CONFIGURACIONES PUERTOS --------------------------------------
0045    0000            ;------------------------------ PUERTO A y E JEFF --------------------------------------
0046    0000    1283    	bcf STATUS,RP0 ;Ir banco 0
0047    0001    1303    	bcf STATUS,RP1
0048    0002    3041    	movlw b'01000001' ;A/D conversion Fosc/8
0049    0003    009F    	movwf ADCON0
0050    0004            	;     	     7     6     5    4    3    2       1 0
0051    0004            	; 1Fh ADCON0 ADCS1 ADCS0 CHS2 CHS1 CHS0 GO/DONE ? ADON
0052    0004    1683    	bsf STATUS,RP0 ;Ir banco 1
0053    0005    1303    	bcf STATUS,RP1
0054    0006    3007    	movlw b'00000111'
0055    0007    0081    	movwf OPTION_REG ;TMR0 preescaler, 1:156
0056    0008            	;                7    6      5    4    3   2   1   0 
0057    0008            	; 81h OPTION_REG RBPU INTEDG T0CS T0SE PSA PS2 PS1 PS0
0058    0008    300E    	movlw b'00001110' ;A/D Port AN0/RA0
0059    0009    009F    	movwf ADCON1
0060    000A            	;            7    6     5 4 3     2     1     0 
0061    000A            	; 9Fh ADCON1 ADFM ADCS2 ? ? PCFG3 PCFG2 PCFG1 PCFG0
0062    000A    1405    	bsf TRISA,0 ;RA0 linea de entrada para el ADC
0063    000B    1283    	bcf STATUS,RP0 ;Ir banco 0
0064    000C    1303    	bcf STATUS,RP1
0065    000D            
0066    000D            ;------------------------------ PUERTO A y E --------------------------------------
0067    000D    3000    	MOVLW b'00000000'
0068    000E    00AB    	MOVWF ContadorBTN
0069    000F    00AE    	MOVWF DATO_DISPLAY
0070    0010            	
0071    0010            
0072    0010            ;----Desactive estas configuraiones para poder ver lo de JEFF
0073    0010            	;BSF     STATUS,RP0
0074    0010                ;BCF     STATUS,RP1
0075    0010                ;MOVLW   D'14'
0076    0010                ;MOVWF   ADCON1
0077    0010            	;MOVLW	B'111'
0078    0010                ;MOVWF   TRISE
0079    0010                ;BCF     STATUS,RP0
0080    0010                ;BCF     STATUS,RP1
0081    0010            
0082    0010    3007        	MOVLW   D'7'
0083    0011    00AD        	MOVWF   NumGrupo
0084    0012            ;------------------------------ PUERTO B --------------------------------------
0085    0012    1683    	BSF STATUS, 5 ;PONE 1 EN STATUS BIT 5 PARA MOVERNOS AL BANCO 1
0086    0013    0186    	CLRF TRISB; PONE EN 0 TRIS B Y LA BANDERA Z PONE SALIDA B 
0087    0014    0187    	CLRF TRISC; HABILITA EL PUERTO C COMO SALIDA
0088    0015            
0089    0015    0100    	CLRW; LIMPIAR W 
0090    0016    1283    	BCF STATUS, 5; PONE UN 0 EN BIT 5 Y NOS MOVEMOS AL BANCO 0 
0091    0017    3004    	MOVLW	4
0092    0018    00A8    	MOVWF	NumeroIteracionesX
0093    0019            ;------------------------------ PUERTO C --------------------------------------
0094    0019    30FF    	MOVLW B'11111111'
0095    001A    00AE    	MOVWF DATO_DISPLAY
0096    001B            
0097    001B            ;--------------Configuracion de Mayores y menores
0098    001B    3000    	MOVLW D'0'
0099    001C    00B6    	MOVWF Mayor_Encontrado
0100    001D    3009    	MOVLW D'9'
0101    001E    00B7    	MOVWF Menor_Encontrado
0102    001F            
0103    001F            
0104    001F            
0105    001F            
0106    001F            
0107    001F            ;PRUEBA para regresar el motor al mayor de luz  ELIMINAR
0108    001F            	;MOVLW	1 ; Moviendo a w El numero de iteraciones que vaya
0109    001F            	;MOVWF	IrMayorXIteracion 
0110    001F            	;MOVLW	45; Moviendo a W el numero de pasos que vaya en Y
0111    001F            	;MOVWF	IrMayorPasosY 
0112    001F            
0113    001F    2820    	GOTO	MENU ;mueve el ip al punto de la etiqueta
0114    0020            
0115    0020            ;--------------------------MENU PROGRAMA-------------------------------
0116    0020            MENU 
0117    0020    3000    	MOVLW	B'00000000'
0118    0021    0086    	MOVWF	PORTB
0119    0022    2026    	CALL	LOOP_GENERAL ; Mover Motores y buscar mayor luz 
0120    0023    2084    	CALL	IrMayorLuz ;Moverme a Buscar LUz
0121    0024    28AA    	GOTO	LEER_E_BTN
0122    0025            	;GOTO FotoResistencia ;Para Graduar Foto Resistencia 
0123    0025    288B    	GOTO	SALIR	
0124    0026            
0125    0026            
0126    0026            ;------------------------------ MOTORES INICIO --------------------------------------
0127    0026            LOOP_GENERAL
0128    0026    3080    	MOVLW	128
0129    0027    00A4    	MOVWF	PasosX
0130    0028    00A5    	MOVWF	PasosRegresoX
0131    0029    203A    	CALL	MOVER_X
0132    002A    3080    	MOVLW	128
0133    002B    00A6    	MOVWF	PasosY
0134    002C    00A7    	MOVWF	PasosRegresoY
0135    002D    0AB9    	INCF	ContMotor,1
0136    002E    2065    	CALL	CORRIDAY
0137    002F    0BA8    	DECFSZ	NumeroIteracionesX, 1
0138    0030    2826    	GOTO	LOOP_GENERAL
0139    0031    3004    	MOVLW	4
0140    0032    00A8    	MOVWF	NumeroIteracionesX
0141    0033    2834    	GOTO	LOOP_REGRESO_X
0142    0034            
0143    0034            LOOP_REGRESO_X
0144    0034    3080    	MOVLW	128
0145    0035    00A5    	MOVWF	PasosRegresoX
0146    0036    2056    	CALL	REGRESOX
0147    0037    0BA8    	DECFSZ	NumeroIteracionesX, 1
0148    0038    2834    	GOTO	LOOP_REGRESO_X
0149    0039            	;GOTO	FIN
0150    0039    3400    	RETLW	B'00000000'
0151    003A            
0152    003A            MOVER_X
0153    003A    300C    	MOVLW	B'00001100'
0154    003B    0086    	MOVWF	PORTB
0155    003C    2049    	CALL	DelayOneSecond
0156    003D    3006    	MOVLW	B'00000110'
0157    003E    0086    	MOVWF	PORTB
0158    003F    2049    	CALL	DelayOneSecond
0159    0040    3003    	MOVLW	B'00000011'
0160    0041    0086    	MOVWF	PORTB
0161    0042    2049    	CALL	DelayOneSecond
0162    0043    3009    	MOVLW	B'00001001'
0163    0044    0086    	MOVWF	PORTB
0164    0045    2049    	CALL	DelayOneSecond
0165    0046    0BA4    	DECFSZ	PasosX,1
0166    0047    283A    	GOTO	MOVER_X
0167    0048    3400    	RETLW	B'00000000'
0168    0049            
0169    0049            DelayOneSecond
0170    0049    3001    	movlw D'1'
0171    004A    00A3    	movwf CounterC
0172    004B    3004    	movlw D'4'
0173    004C    00A2    	movwf CounterB
0174    004D    3004    	movlw D'4'
0175    004E    00A1    	movwf CounterA
0176    004F            
0177    004F            Loop_Delay
0178    004F    0BA1    	decfsz CounterA,1
0179    0050    284F    	goto Loop_Delay
0180    0051    0BA2    	decfsz CounterB,1
0181    0052    284F    	goto Loop_Delay
0182    0053    0BA3    	decfsz CounterC,1
0183    0054    284F    	goto Loop_Delay
0184    0055    3400    	RETLW	b'00000000'
0185    0056            
0186    0056            REGRESOX
0187    0056    3009    	MOVLW	B'00001001'
0188    0057    0086    	MOVWF	PORTB
0189    0058    2049    	CALL	DelayOneSecond
0190    0059    3003    	MOVLW	B'00000011'
0191    005A    0086    	MOVWF	PORTB
0192    005B    2049    	CALL	DelayOneSecond
0193    005C    3006    	MOVLW	B'00000110'
0194    005D    0086    	MOVWF	PORTB
0195    005E    2049    	CALL	DelayOneSecond
0196    005F    300C    	MOVLW	B'00001100'
0197    0060    0086    	MOVWF	PORTB
0198    0061    2049    	CALL	DelayOneSecond
0199    0062    0BA5    	DECFSZ	PasosRegresoX,1
0200    0063    2856    	GOTO	REGRESOX
0201    0064    3400    	RETLW	B'00000000'
0202    0065            
0203    0065            CORRIDAY
0204    0065    2151    	CALL	BuscarYMarcarFoto
0205    0066    30C0       	MOVLW	B'11000000'
0206    0067    0086    	MOVWF	PORTB
0207    0068    2049    	CALL	DelayOneSecond
0208    0069    3060    	MOVLW	B'01100000'
0209    006A    0086    	MOVWF	PORTB
0210    006B    2049    	CALL	DelayOneSecond
0211    006C    3030    	MOVLW	B'00110000'
0212    006D    0086    	MOVWF	PORTB
0213    006E    2049    	CALL	DelayOneSecond
0214    006F    3090    	MOVLW	B'10010000'
0215    0070    0086    	MOVWF	PORTB
0216    0071    2049    	CALL	DelayOneSecond
0217    0072    0BA6    	DECFSZ	PasosY ,1
0218    0073    2865    	GOTO	CORRIDAY
0219    0074    2875    	GOTO	REGRESOY
0220    0075            
0221    0075            REGRESOY
0222    0075    3090        	MOVLW	B'10010000'
0223    0076    0086    	MOVWF	PORTB
0224    0077    2049    	CALL	DelayOneSecond
0225    0078    3030    	MOVLW	B'00110000'
0226    0079    0086    	MOVWF	PORTB
0227    007A    2049    	CALL	DelayOneSecond
0228    007B    3060    	MOVLW	B'01100000'
0229    007C    0086    	MOVWF	PORTB
0230    007D    2049    	CALL	DelayOneSecond
0231    007E    30C0    	MOVLW	B'11000000'
0232    007F    0086    	MOVWF	PORTB
0233    0080    2049    	CALL	DelayOneSecond
0234    0081    0BA7    	DECFSZ	PasosRegresoY ,1
0235    0082    2875    	GOTO	REGRESOY
0236    0083    3400    	RETLW	B'00000000'
0237    0084            
0238    0084            FIN ; NO se utiliza esta etiqueta se comenta en linea 62 
0239    0084             	;MOVLW	B'00000000'
0240    0084            	;MOVWF	PORTB
0241    0084            	;RETLW	B'00000000'
0242    0084            	;Call	IrMayorLuz
0243    0084            
0244    0084            
0245    0084            IrMayorLuz
0246    0084    3080    	MOVLW	128
0247    0085    00A4    	MOVWF	PasosX
0248    0086    208C    	CALL	FullMayorX
0249    0087    0BA9    	DECFSZ	IrMayorXIteracion , 1
0250    0088    2884    	GOTO	IrMayorLuz
0251    0089    209B    	CALL	FullMayorY
0252    008A    3400    	RETLW	B'00000000'
0253    008B            
0254    008B            SALIR
0255    008B            	END
0256    008B    288B    	GOTO SALIR
0257    008C            
0258    008C            FullMayorX
0259    008C    300C    	MOVLW	B'00001100'
0260    008D    0086    	MOVWF	PORTB
0261    008E    2049    	CALL	DelayOneSecond
0262    008F    3006    	MOVLW	B'00000110'
0263    0090    0086    	MOVWF	PORTB
0264    0091    2049    	CALL	DelayOneSecond
0265    0092    3003    	MOVLW	B'00000011'
0266    0093    0086    	MOVWF	PORTB
0267    0094    2049    	CALL	DelayOneSecond
0268    0095    3009    	MOVLW	B'00001001'
0269    0096    0086    	MOVWF	PORTB
0270    0097    2049    	CALL	DelayOneSecond
0271    0098    0BA4    	DECFSZ	PasosX,1
0272    0099    288C    	GOTO	FullMayorX
0273    009A    3400    	RETLW	B'00000000'
0274    009B            
0275    009B            FullMayorY
0276    009B    30C0       	MOVLW	B'11000000'
0277    009C    0086    	MOVWF	PORTB
0278    009D    2049    	CALL	DelayOneSecond
0279    009E    3060    	MOVLW	B'01100000'
0280    009F    0086    	MOVWF	PORTB
0281    00A0    2049    	CALL	DelayOneSecond
0282    00A1    3030    	MOVLW	B'00110000'
0283    00A2    0086    	MOVWF	PORTB
0284    00A3    2049    	CALL	DelayOneSecond
0285    00A4    3090    	MOVLW	B'10010000'
0286    00A5    0086    	MOVWF	PORTB
0287    00A6    2049    	CALL	DelayOneSecond
0288    00A7    0BAA    	DECFSZ	IrMayorPasosY ,1
0289    00A8    289B    	GOTO	FullMayorY
0290    00A9    3400    	RETLW	B'00000000'
0291    00AA            
0292    00AA            ;------------------------------ BOTON E 0 INICIAL -----------------------------------------
0293    00AA            LEER_E_BTN
0294    00AA    0809    	MOVF PORTE, W ;Movemos lo de PUERTO E hacia W
0295    00AB    00AC    	MOVWF DatoEnE ;Movemos la variable hacia dato en E
0296    00AC    3001    	MOVLW B'001' ; MOVEMOS A W EL 0 BIT de E  
0297    00AD    022C    	SUBWF DatoEnE,W ;VA A RESTARLE AL DATO E LO QUE ESTA EN W
0298    00AE    21C5    	CALL	Llamada16Delays
0299    00AF    1903    	BTFSC STATUS, Z ; VERIFICA QUE EL STATUS DE LA OPERACION SEA 0 
0300    00B0    28B2    	GOTO  CONTAR ; SI LA OPERACION ES 0 SE VA A UN CONTAR
0301    00B1    28AA    	GOTO  LEER_E_BTN ;REGRESA LOOP LEER
0302    00B2            
0303    00B2            CONTAR
0304    00B2    0A2B    	INCF  ContadorBTN, 0 ;incrementa e ContadorBTN en 1
0305    00B3    00AB    	MOVWF ContadorBTN
0306    00B4    3001    	MOVLW b'00000001'
0307    00B5    022B    	SUBWF ContadorBTN,W
0308    00B6    1903    	BTFSC STATUS, Z
0309    00B7    28C4    	GOTO  BTN1
0310    00B8            
0311    00B8    3002    	MOVLW b'00000010'
0312    00B9    022B    	SUBWF ContadorBTN,W
0313    00BA    1903    	BTFSC STATUS, Z
0314    00BB    28F7    	GOTO  BTN2
0315    00BC            
0316    00BC    3003    	MOVLW b'00000011'
0317    00BD    022B    	SUBWF ContadorBTN,W
0318    00BE    1903    	BTFSC STATUS, Z
0319    00BF    28FB    	GOTO  BTN3
0320    00C0            
0321    00C0    3004    	MOVLW b'00000100'
0322    00C1    022B    	SUBWF ContadorBTN, 0
0323    00C2    1903    	BTFSC STATUS, Z
0324    00C3    28FF    	GOTO  BTN4
0325    00C4            
0326    00C4            BTN1
0327    00C4            ;Al iniciar, mostrar cu�nto es el �ndice de luz (escala definida por el grupo)
0328    00C4            	;MOVLW B'00000001'
0329    00C4            	;MOVWF PORTB
0330    00C4            
0331    00C4    3000    	MOVLW D'0'
0332    00C5    00AE    	MOVWF DATO_DISPLAY
0333    00C6    2105    	CALL  COMP_DISPLAY
0334    00C7    21C5    	CALL	Llamada16Delays
0335    00C8    21C5    	CALL	Llamada16Delays
0336    00C9            
0337    00C9    3001    	MOVLW D'1'
0338    00CA    00AE    	MOVWF DATO_DISPLAY
0339    00CB    2105    	CALL  COMP_DISPLAY
0340    00CC    21C5    	CALL	Llamada16Delays
0341    00CD    21C5    	CALL	Llamada16Delays
0342    00CE            
0343    00CE    3002    	MOVLW D'2'
0344    00CF    00AE    	MOVWF DATO_DISPLAY
0345    00D0    2105    	CALL  COMP_DISPLAY
0346    00D1    21C5    	CALL	Llamada16Delays
0347    00D2    21C5    	CALL	Llamada16Delays
0348    00D3            
0349    00D3    3003    	MOVLW D'3'
0350    00D4    00AE    	MOVWF DATO_DISPLAY
0351    00D5    2105    	CALL  COMP_DISPLAY
0352    00D6    21C5    	CALL	Llamada16Delays
0353    00D7    21C5    	CALL	Llamada16Delays
0354    00D8            
0355    00D8    3004    	MOVLW D'4'
0356    00D9    00AE    	MOVWF DATO_DISPLAY
0357    00DA    2105    	CALL  COMP_DISPLAY
0358    00DB    21C5    	CALL	Llamada16Delays
0359    00DC    21C5    	CALL	Llamada16Delays
0360    00DD            
0361    00DD    3005    	MOVLW D'5'
0362    00DE    00AE    	MOVWF DATO_DISPLAY
0363    00DF    2105    	CALL  COMP_DISPLAY
0364    00E0    21C5    	CALL	Llamada16Delays
0365    00E1    21C5    	CALL	Llamada16Delays
0366    00E2            
0367    00E2    3006    	MOVLW D'6'
0368    00E3    00AE    	MOVWF DATO_DISPLAY
0369    00E4    2105    	CALL  COMP_DISPLAY
0370    00E5    21C5    	CALL	Llamada16Delays
0371    00E6    21C5    	CALL	Llamada16Delays
0372    00E7            
0373    00E7    3007    	MOVLW D'7'
0374    00E8    00AE    	MOVWF DATO_DISPLAY
0375    00E9    2105    	CALL  COMP_DISPLAY
0376    00EA    21C5    	CALL	Llamada16Delays
0377    00EB    21C5    	CALL	Llamada16Delays
0378    00EC            
0379    00EC    3008    	MOVLW D'8'
0380    00ED    00AE    	MOVWF DATO_DISPLAY
0381    00EE    2105    	CALL  COMP_DISPLAY
0382    00EF    21C5    	CALL	Llamada16Delays
0383    00F0    21C5    	CALL	Llamada16Delays
0384    00F1            
0385    00F1    3009    	MOVLW D'9'
0386    00F2    00AE    	MOVWF DATO_DISPLAY
0387    00F3    2105    	CALL  COMP_DISPLAY
0388    00F4    21C5    	CALL	Llamada16Delays
0389    00F5    21C5    	CALL	Llamada16Delays
0390    00F6            
0391    00F6    28AA    	GOTO  LEER_E_BTN
0392    00F7            	;Mostrar el primer inciso
0393    00F7            BTN2
0394    00F7            ;Al presionar la tecla cambiar� y deber� mostrar el n�mero del dispositivo con la mayor
0395    00F7            ;cantidad de luz.
0396    00F7            	;MOVLW B'00000010'
0397    00F7            	;MOVWF PORTB
0398    00F7            	
0399    00F7    3002    	MOVLW D'2'
0400    00F8    00AE    	MOVWF DATO_DISPLAY
0401    00F9            
0402    00F9    2105    	CALL  COMP_DISPLAY
0403    00FA            
0404    00FA    28AA    	GOTO  LEER_E_BTN
0405    00FB            	;Mostrar el segundo inciso
0406    00FB            BTN3
0407    00FB            ;Al presionar la tecla cambiar� y deber� mostrar el n�mero del dispositivo con la menor
0408    00FB            ;cantidad de luz.
0409    00FB            	;MOVLW B'00000100'
0410    00FB            	;MOVWF PORTB
0411    00FB            
0412    00FB    3003    	MOVLW D'3'
0413    00FC    00AE    	MOVWF DATO_DISPLAY
0414    00FD    2105    	CALL  COMP_DISPLAY
0415    00FE            
0416    00FE    28AA    	GOTO  LEER_E_BTN
0417    00FF            	;Mostrar el tercer inciso
0418    00FF            BTN4       ;Al presionar la tecla cambiar� y mostrar� cu�l es su n�mero de dispositivo
0419    00FF            	;MOVLW B'00001000'
0420    00FF            	;MOVWF PORTB
0421    00FF            
0422    00FF    3000    	MOVLW B'00000000' 
0423    0100    00AB    	MOVWF ContadorBTN ;resetea el ContadorBTN para empezar de nuevo
0424    0101            
0425    0101    3004    	MOVLW D'4'
0426    0102    00AE    	MOVWF DATO_DISPLAY
0427    0103    2105    	CALL  COMP_DISPLAY
0428    0104    28AA    	GOTO  LEER_E_BTN
0429    0105            
0430    0105            
0431    0105            ;------------------------------ DISPLAY  -----------------------------------------
0432    0105            
0433    0105            COMP_DISPLAY
0434    0105            ;COMPARACION BIT POR BIT 
0435    0105    3000    	MOVLW	B'00000000' ;LE ENVIAMOS A W EL NUMERO 0 EN BINARIO EN 8 BITS
0436    0106    022E    	SUBWF	DATO_DISPLAY,W 	;LE VAMOS A QUITAR A DATO_DISPLAY W (DATO_DISPLAY-W)=W
0437    0107    1903    	BTFSC	STATUS,Z
0438    0108    292E    	GOTO	MOSTRAR0
0439    0109            
0440    0109    3001    	MOVLW	B'00000001' ;LE ENVIAMOS A W EL NUMERO 1 EN BINARIO EN 8 BITS
0441    010A    022E    	SUBWF	DATO_DISPLAY,W 	;LE VAMOS A QUITAR A DATO_DISPLAY W (DATO_DISPLAY-W)=W
0442    010B    1903    	BTFSC	STATUS,Z
0443    010C    2931    	GOTO	MOSTRAR1
0444    010D            
0445    010D    3002    	MOVLW	B'00000010' ;LE ENVIAMOS A W EL NUMERO 2 EN BINARIO EN 8 BITS
0446    010E    022E    	SUBWF	DATO_DISPLAY,W 	;LE VAMOS A QUITAR A DATO_DISPLAY W (DATO_DISPLAY-W)=W
0447    010F    1903    	BTFSC	STATUS,Z
0448    0110    2934    	GOTO	MOSTRAR2
0449    0111            	
0450    0111    3003    	MOVLW	B'00000011' ;LE ENVIAMOS A W EL NUMERO 3 EN BINARIO EN 8 BITS
0451    0112    022E    	SUBWF	DATO_DISPLAY,W 	;LE VAMOS A QUITAR A DATO_DISPLAY W (DATO_DISPLAY-W)=W
0452    0113    1903    	BTFSC	STATUS,Z
0453    0114    2937    	GOTO	MOSTRAR3
0454    0115            
0455    0115    3004    	MOVLW	B'00000100' ;LE ENVIAMOS A W EL NUMERO 4 EN BINARIO EN 8 BITS
0456    0116    022E    	SUBWF	DATO_DISPLAY,W 	;LE VAMOS A QUITAR A DATO_DISPLAY W (DATO_DISPLAY-W)=W
0457    0117    1903    	BTFSC	STATUS,Z
0458    0118    293A    	GOTO	MOSTRAR4
0459    0119            
0460    0119    3005    	MOVLW	B'00000101' ;LE ENVIAMOS A W EL NUMERO 5 EN BINARIO EN 8 BITS
0461    011A    022E    	SUBWF	DATO_DISPLAY,W 	;LE VAMOS A QUITAR A DATO_DISPLAY W (DATO_DISPLAY-W)=W
0462    011B    1903    	BTFSC	STATUS,Z
0463    011C    293D    	GOTO	MOSTRAR5
0464    011D            
0465    011D    3006    	MOVLW	B'00000110' ;LE ENVIAMOS A W EL NUMERO 6 EN BINARIO EN 8 BITS
0466    011E    022E    	SUBWF	DATO_DISPLAY,W 	;LE VAMOS A QUITAR A DATO_DISPLAY W (DATO_DISPLAY-W)=W
0467    011F    1903    	BTFSC	STATUS,Z
0468    0120    2940    	GOTO	MOSTRAR6
0469    0121            
0470    0121    3007    	MOVLW	B'00000111' ;LE ENVIAMOS A W EL NUMERO 7 EN BINARIO EN 8 BITS
0471    0122    022E    	SUBWF	DATO_DISPLAY,W 	;LE VAMOS A QUITAR A DATO_DISPLAY W (DATO_DISPLAY-W)=W
0472    0123    1903    	BTFSC	STATUS,Z
0473    0124    2943    	GOTO	MOSTRAR7
0474    0125            
0475    0125    3008    	MOVLW	B'00001000' ;LE ENVIAMOS A W EL NUMERO 8 EN BINARIO EN 8 BITS
0476    0126    022E    	SUBWF	DATO_DISPLAY,W 	;LE VAMOS A QUITAR A DATO_DISPLAY W (DATO_DISPLAY-W)=W
0477    0127    1903    	BTFSC	STATUS,Z
0478    0128    2946    	GOTO	MOSTRAR8
0479    0129            
0480    0129    3009    	MOVLW	B'00001001' ;LE ENVIAMOS A W EL NUMERO 9 EN BINARIO EN 8 BITS
0481    012A    022E    	SUBWF	DATO_DISPLAY,W 	;LE VAMOS A QUITAR A DATO_DISPLAY W (DATO_DISPLAY-W)=W
0482    012B    1903    	BTFSC	STATUS,Z
0483    012C    2949    	GOTO	MOSTRAR9
0484    012D            	
0485    012D            	;MOVLW	B'00000000'
0486    012D            	;MOVWF	PORTB
0487    012D    28AA    	GOTO	LEER_E_BTN
0488    012E            
0489    012E            MOSTRAR0
0490    012E    30C0    	MOVLW B'11000000' ; EN BINARIO PONEMOS 0 LOS NECESARIOS PARA PREDER EL DISPLAY EN 0
0491    012F    0087    	MOVWF PORTC	;MOVEMOS LOS BINARIOS A PORT B 
0492    0130    3400    	RETLW	B'00000000'
0493    0131            
0494    0131            MOSTRAR1
0495    0131    30F9    	MOVLW B'11111001' ; EN BINARIO PONEMOS 1 LOS NECESARIOS PARA PREDER EL DISPLAY EN 0
0496    0132    0087    	MOVWF PORTC	;MOVEMOS LOS BINARIOS A PORT B 
0497    0133    3400    	RETLW	B'00000000'
0498    0134            
0499    0134            MOSTRAR2
0500    0134    30A4    	MOVLW B'10100100' ; EN BINARIO PONEMOS 2 LOS NECESARIOS PARA PREDER EL DISPLAY EN 0
0501    0135    0087    	MOVWF PORTC	;MOVEMOS LOS BINARIOS A PORT B 
0502    0136    3400    	RETLW	B'00000000'
0503    0137            
0504    0137            MOSTRAR3
0505    0137    30B0    	MOVLW B'10110000' ; EN BINARIO PONEMOS 3 LOS NECESARIOS PARA PREDER EL DISPLAY EN 0
0506    0138    0087    	MOVWF PORTC	;MOVEMOS LOS BINARIOS A PORT B 
0507    0139    3400    	RETLW	B'00000000'
0508    013A            		
0509    013A            MOSTRAR4
0510    013A    3099    	MOVLW B'10011001' ; EN BINARIO PONEMOS 4 LOS NECESARIOS PARA PREDER EL DISPLAY EN 0
0511    013B    0087    	MOVWF PORTC	;MOVEMOS LOS BINARIOS A PORT B 
0512    013C    3400    	RETLW	B'00000000'
0513    013D            
0514    013D            MOSTRAR5
0515    013D    3092    	MOVLW B'10010010' ; EN BINARIO PONEMOS 5 LOS NECESARIOS PARA PREDER EL DISPLAY EN 0
0516    013E    0087    	MOVWF PORTC	;MOVEMOS LOS BINARIOS A PORT B 
0517    013F    3400    	RETLW	B'00000000'
0518    0140            
0519    0140            MOSTRAR6
0520    0140    3082    	MOVLW B'10000010' ; EN BINARIO PONEMOS 6 LOS NECESARIOS PARA PREDER EL DISPLAY EN 0
0521    0141    0087    	MOVWF PORTC	;MOVEMOS LOS BINARIOS A PORT B 
0522    0142    3400    	RETLW	B'00000000'
0523    0143            
0524    0143            MOSTRAR7
0525    0143    30F8    	MOVLW B'11111000' ; EN BINARIO PONEMOS 7 LOS NECESARIOS PARA PREDER EL DISPLAY EN 0
0526    0144    0087    	MOVWF PORTC	;MOVEMOS LOS BINARIOS A PORT B 
0527    0145    3400    	RETLW	B'00000000'
0528    0146            
0529    0146            MOSTRAR8
0530    0146    3080    	MOVLW B'10000000' ; EN BINARIO PONEMOS 8 LOS NECESARIOS PARA PREDER EL DISPLAY EN 0
0531    0147    0087    	MOVWF PORTC	;MOVEMOS LOS BINARIOS A PORT B 
0532    0148    3400    	RETLW	B'00000000'
0533    0149            
0534    0149            MOSTRAR9
0535    0149    3098    	MOVLW B'10011000' ; EN BINARIO PONEMOS 9 LOS NECESARIOS PARA PREDER EL DISPLAY EN 0
0536    014A    0087    	MOVWF PORTC	;MOVEMOS LOS BINARIOS A PORT B 
0537    014B    3400    	RETLW	B'00000000'
0538    014C            
0539    014C            ;------------------------------FOTO RESISTENCIA  -----------------------------------------
0540    014C            FotoResistencia
0541    014C    2156    	CALL _bucle
0542    014D    0835    	MOVF	CATEGORIA,W
0543    014E    00AE    	MOVWF DATO_DISPLAY
0544    014F    2105    	CALL  COMP_DISPLAY
0545    0150    294C    	GOTO FotoResistencia
0546    0151            
0547    0151            BuscarYMarcarFoto
0548    0151    2156    	Call _bucle
0549    0152    0835    	MovF categoria,W
0550    0153    00B8    	MOVWF ENTRADA_Comp
0551    0154    21B2    	Call Comparacion_nums
0552    0155    0008    	RETURN
0553    0156            
0554    0156            _bucle
0555    0156            	;btfss INTCON,T0IF
0556    0156            	;goto _bucle ;Esperar que el timer0 desborde
0557    0156            	; SE DEBE DE COLOCAR UN DELAY PARA QUE ESPERE LA CONVERSION
0558    0156    1503    	BSF  STATUS,Z
0559    0157    2162    	CALL _PRESPERA
0560    0158    110B    	bcf INTCON,T0IF ;Limpiar el indicador de desborde
0561    0159    151F    	bsf ADCON0,GO ;Comenzar conversion A/D
0562    015A            _espera
0563    015A    191F    	btfsc ADCON0,GO ;ADCON0 es 0? (la conversion esta completa?)
0564    015B    295A    	goto _espera ;No, ir _espera
0565    015C    081E    	movf ADRESH,W ;Si, W=ADRESH
0566    015D            	; 1Eh ADRESH A/D Result Register High Byte
0567    015D            	; 9Eh ADRESL A/D Result Register Low Byte 
0568    015D    00AF    	movwf ADC ;ADC=W
0569    015E            	;rrf ADC,F ;ADC /4
0570    015E            	;rrf ADC,F
0571    015E            	;bcf ADC,7
0572    015E            	;bcf ADC,6
0573    015E    082F    	movfw ADC ;W = ADC
0574    015F            	;movwf PORTB ;PORTB = W
0575    015F    2173    	CALL INTERVALOS
0576    0160    21A3    	CALL COMPARACION_Foto
0577    0161    0008    	RETURN
0578    0162            	;movlw D'32' ;Comparamos el valor del ADC para saber si es menor que 128
0579    0162            	;subwf ADC,W
0580    0162            	;btfss STATUS,C ;Es mayor a 128?
0581    0162            	;goto _desactivar ;No, desactivar RB7
0582    0162            	;bsf PORTC,7 ;Si, RB7 = 1 logico
0583    0162            	;goto _bucle ;Ir bucle
0584    0162            ;_desactivar
0585    0162            	;bcf PORTB,7 ;RB7 = 0 logico
0586    0162            	;goto _bucle ;Ir bucle
0587    0162            	
0588    0162            _PRESPERA
0589    0162    30FF    	MOVLW 0XFF
0590    0163    00B0    	MOVWF CON
0591    0164    00B1    	MOVWF CON2
0592    0165    00B2    	MOVWF CON3	
0593    0166    2168    	CALL ESPE
0594    0167    0008    	RETURN	
0595    0168            
0596    0168            ESPE
0597    0168    0BB0    	DECFSZ	CON,0X01
0598    0169    2968    	GOTO	ESPE
0599    016A    216C    	CALL	ESPE2
0600    016B    0008    	RETURN
0601    016C            ESPE2
0602    016C    0BB1    	DECFSZ	CON2,0X01
0603    016D    296C    	GOTO	ESPE2
0604    016E    2170    	CALL	ESPE3
0605    016F    0008    	RETURN
0606    0170            ESPE3
0607    0170    0BB2    	DECFSZ	CON3,0X01
0608    0171    2970    	GOTO	ESPE3
0609    0172    0008    	RETURN
0610    0173            
0611    0173            INTERVALOS
0612    0173    3009    	MOVLW	D'9'
0613    0174    00B5    	MOVWF	CATEGORIA
0614    0175            
0615    0175    30D2    	movlw	d'210'
0616    0176    022F    	subwf	ADC, 0
0617    0177    1803    	BTFSc	STATUS, C
0618    0178    0008    	RETURN
0619    0179            
0620    0179    03B5    	DECF	categoria,1
0621    017A    30C2    	movlw	d'194'
0622    017B    022F    	subwf	ADC, 0
0623    017C    1803    	BTFSC STATUS, C
0624    017D    0008    	return
0625    017E            
0626    017E    03B5    	DECF	categoria,1
0627    017F    30AE    	movlw	d'174'
0628    0180    022F    	subwf	ADC, 0
0629    0181    1803    	BTFSC STATUS, C
0630    0182    0008    	return
0631    0183            
0632    0183    03B5    	DECF	categoria,1
0633    0184    309E    	movlw	d'158'
0634    0185    022F    	subwf	ADC, 0
0635    0186    1803    	BTFSC STATUS, C
0636    0187    0008    	return
0637    0188            
0638    0188    03B5    	DECF	categoria,1
0639    0189    308A    	movlw	d'138'
0640    018A    022F    	subwf	ADC, 0
0641    018B    1803    	BTFSC STATUS, C
0642    018C    0008    	return
0643    018D            
0644    018D    03B5    	DECF	categoria,1
0645    018E    3075    	movlw	d'117'
0646    018F    022F    	subwf	ADC, 0
0647    0190    1803    	BTFSC STATUS, C
0648    0191    0008    	return
0649    0192            
0650    0192    03B5    	DECF	categoria,1
0651    0193    3052    	movlw	d'82'
0652    0194    022F    	subwf	ADC, 0
0653    0195    1803    	BTFSC STATUS, C
0654    0196    0008    	return
0655    0197            
0656    0197    03B5    	DECF	categoria,1
0657    0198    3033    	movlw	d'51'
0658    0199    022F    	subwf	ADC, 0
0659    019A    1803    	BTFSC STATUS, C
0660    019B    0008    	return
0661    019C            
0662    019C    03B5    	DECF	categoria,1
0663    019D    301C    	movlw	d'28'
0664    019E    022F    	subwf	ADC, 0
0665    019F    1803    	BTFSC STATUS, C
0666    01A0    0008    	return
0667    01A1            	
0668    01A1    03B5    	DECF	categoria, 1
0669    01A2    0008    	return
0670    01A3            
0671    01A3            COMPARACION_Foto	
0672    01A3    0835    	MOVF	CATEGORIA,W
0673    01A4    0234    	SUBWF	MENOR_LUZR,W	
0674    01A5    1803    	BTFSC	STATUS,C
0675    01A6    21AF    	CALL	EntradaMenor
0676    01A7            
0677    01A7    0835    	MOVF	CATEGORIA,W
0678    01A8    0233    	SUBWF	MAYOR_LUZR,W
0679    01A9    1C03    	BTFSS	STATUS,C
0680    01AA    21AC    	CALL 	EntradaMayor
0681    01AB            
0682    01AB    0008    	RETURN
0683    01AC            
0684    01AC            EntradaMayor
0685    01AC    0835    	MOVF	CATEGORIA,W
0686    01AD    00B3    	MOVWF	MAYOR_LUZR
0687    01AE            	;MOVLW	B'00000001'
0688    01AE            	;MOVWF	PORTD
0689    01AE    0008    	RETURN
0690    01AF            
0691    01AF            EntradaMenor
0692    01AF    0835    	MOVF	CATEGORIA,W
0693    01B0    00B4    	MOVWF	MENOR_LUZR
0694    01B1            	;MOVLW	B'00000010'
0695    01B1            	;MOVWF	PORTD
0696    01B1    0008    	RETURN
0697    01B2            ;--------------------------Compracion numeros-------
0698    01B2            Comparacion_nums	
0699    01B2    0838    	MOVF	ENTRADA_Comp,W
0700    01B3    0237    	SUBWF	Menor_Encontrado,W	
0701    01B4    1803    	BTFSC	STATUS,C
0702    01B5    21C2    	CALL	EntradaMenor_nums
0703    01B6            
0704    01B6    0838    	MOVF	ENTRADA_Comp,W
0705    01B7    0236    	SUBWF	Mayor_Encontrado,W
0706    01B8    1C03    	BTFSS	STATUS,C
0707    01B9    21BB    	CALL 	EntradaMayor_nums
0708    01BA            
0709    01BA    0008    	RETURN
0710    01BB            
0711    01BB            EntradaMayor_nums
0712    01BB    0838    	MOVF	ENTRADA_Comp,W
0713    01BC    00B6    	MOVWF	Mayor_Encontrado
0714    01BD            	;Moviendo la Iteracion X y Moviento en y
0715    01BD    0839    	MOVF 	ContMotor,W
0716    01BE    00A9    	MOVWF	IrMayorXIteracion
0717    01BF            	;INCF	IrMayorXIteracion,1
0718    01BF            
0719    01BF    0826    	MOVF 	PasosY,W
0720    01C0    00AA    	MOVWF	IrMayorPasosY
0721    01C1            
0722    01C1            	;MOVLW	B'00000001'
0723    01C1            	;MOVWF	PORTD
0724    01C1    0008    	RETURN
0725    01C2            
0726    01C2            EntradaMenor_nums
0727    01C2    0838    	MOVF	ENTRADA_Comp,W
0728    01C3    00B7    	MOVWF	Menor_Encontrado
0729    01C4            	;MOVLW	B'00000010'
0730    01C4            	;MOVWF	PORTD
0731    01C4    0008    	RETURN
0732    01C5            
0733    01C5            Llamada16Delays
0734    01C5    2049    	CALL	DelayOneSecond
0735    01C6    2049    	CALL	DelayOneSecond	
0736    01C7    2049    	CALL	DelayOneSecond
0737    01C8    2049    	CALL	DelayOneSecond
0738    01C9    2049    	CALL	DelayOneSecond
0739    01CA    2049    	CALL	DelayOneSecond	
0740    01CB    2049    	CALL	DelayOneSecond
0741    01CC    2049    	CALL	DelayOneSecond
0742    01CD    2049    	CALL	DelayOneSecond
0743    01CE    2049    	CALL	DelayOneSecond	
0744    01CF    2049    	CALL	DelayOneSecond
0745    01D0    2049    	CALL	DelayOneSecond
0746    01D1    2049    	CALL	DelayOneSecond
0747    01D2    2049    	CALL	DelayOneSecond	
0748    01D3    2049    	CALL	DelayOneSecond
0749    01D4    2049    	CALL	DelayOneSecond
0750    01D5    0008    	RETURN
---------------------------------------------
Number of errors = 0
